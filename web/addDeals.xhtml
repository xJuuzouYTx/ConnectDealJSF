<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      >
    <h:head>
        <title>x</title>
          <h:outputStylesheet name="css/addDeals.css"/>
          <h:outputScript name="js/home.js"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    </h:head>
    <body>
           <h:form>
        <div class="modal-content" id="modal-content" >
            <div class="step1" id="step1">
             
                    <div>
                        <span class="close" onclick="closeModal()">&times;</span>
                        <h2>Crear un negocio(Paso 1 de 5)</h2>
                    </div>
                    <div>
                        <h1>Da el primer paso para tener tu negocio</h1>
                        <h:inputText value="#{dealsController.selected.name}"  a:placeholder="Ingresa el nombre de tu negocio" class="input" id="name"/>
                    </div>
                    <div>
                        <f:ajax event="keyup" execute="name" render="messagePanel1"/>
                    </div>
                    <div class="messagePanel">
                        <h:outputLabel value="#{dealsController.messageName}" id="messagePanel1" style="padding: 0; margin: 0;"/>
                    </div>
                    <div class="control">
                        <div class="frontbtn">
                            <input type="button" class="button" value="Continuar" onclick="front(2);" />
                        </div>   
                    </div>
             
            </div>
            <div class="step2" id="step2" style="display: none;">
         
                    <div>
                        <span class="close" onclick="closeModal()">&times;</span>
                        <h2>Crear un negocio(Paso 2 de 5)</h2>
                    </div>
                    <div>
                        <h1>Decribe tu negocio</h1>
                        <h:inputTextarea value="#{dealsController.selected.description}"  a:placeholder="Ingresa una breve descripción de tu negocio" class="inputxt"/>
                    </div>
                    <div>
                        <f:ajax event="keyup" execute="name" render="messagePanel2"/>
                    </div>
                    <div class="messagePanel">
                        <h:outputLabel value="#{dealsController.messageDes}" id="messagePanel2" style="padding: 0; margin: 0;"/>
                    </div>
                    <div class="control">
                        <div class="backbtn">
                            <input type="button" class="button" value="Volver" onclick="back(1)"/>
                        </div>
                        <div class="frontbtn">
                            <input type="button" class="button" value="Continuar" onclick="front(3)"/>
                        </div>   
                    </div>
                
            </div>
             <div class="step3" id="step3" style="display: none;">
                 <div style="margin-top: 100px;">
                    <div>
                        <span class="close" onclick="closeModal()">&times;</span>
                        <h2 >Crear un negocio(Paso 3 de 5)</h2>
                    </div>
                    
                    <h1>¿Donde se Ubica tu negocio.?</h1>
                    <div>
                        <input type="text" id="location" required="true" class="inputLocation" autocomplete="off"/>
                        <div class="coordinates">
                            <input type="hidden" id="latitud" value="" name="lat"/>
                            <input type="hidden" id="longitud" value=""  name="lng"/>
                        </div>
                        <h:commandButton id="comprobeLocation" class="btnLocation" value="Guardar Ubicación" action="#{dealsController.comprobeAddress()}" style="display: inline-block;">
                            <f:ajax />
                        </h:commandButton>
                    </div>
                    
                    <div>
                        <div id="map" class="map"></div>
                    </div>
                    
                    <div class="messagePanel">
                        <h:outputLabel value="" id="messagePanel3" style="padding: 0; margin: 0;"/>
                    </div>
                  
                    <div class="control">
                        <div class="backbtn">
                            <input type="button" class="button" value="Volver" onclick="back(2)"/>
                        </div>
                        <div class="frontbtn">
                            <input type="button" class="button" value="Continuar" onclick="front(4);" />
                        </div>   
                    </div>
                 </div>
            </div>
            <div class="step4" id="step4" style="display: none;">
              
                    <div>
                        <span class="close" onclick="closeModal()">&times;</span>
                        <h2 style="display: inline-block">Crear un negocio(Paso 4 de 5)</h2>
                    </div>
                    <div>
                        <h1>¿Donde te pueden contactar?</h1>
                        <h:inputText value="#{dealsController.selected.phone}"  a:placeholder="Telefono" class="input2" style="display: block; margin: auto;" onkeypress="return valideKey(event);"/>
                        <h:inputText value="#{dealsController.selected.facebook}"  a:placeholder="Facebook" class="input2" style="display: block; margin: auto;"/>
                        <h:inputText value="#{dealsController.selected.instagram}"  a:placeholder="Instagram" class="input2" style="display: block; margin: auto;"/>
                        <h:inputText value="#{dealsController.selected.twitter}"  a:placeholder="Twitter" class="input2" style="display: block; margin: auto;"/>
                        <h:inputText value="#{dealsController.selected.webSite}"  a:placeholder="Sitio Web" class="input2" style="display: block; margin: auto;"/>
                    </div>
                    
                    <div class="control">
                        <div class="backbtn">
                            <input type="button" class="button" value="Volver" onclick="back(3)"/>
                        </div>
                        <div class="frontbtn">
                            <input type="button" class="button" value="Continuar" onclick="front(5);" />
                        </div>   
                    </div>
                
            </div>
            <div class="step5" id="step5" style="display: none;">
         
                    <div>
                        <span class="close" onclick="closeModal()">&times;</span>
                        <h2 style="display: inline-block">Crear un negocio(Paso 5 de 5)</h2>
                    </div>
                    <div>
                        <h1>¿Dale identidad a tu negocio</h1>
                        <div class="image-upload">
                            <label for="file-input">
                                <img  id="blah" width="150" height="150" src="https://icon-library.net/images/upload-photo-icon/upload-photo-icon-21.jpg"/>
                            </label>
                            <input id="file-input" onchange="readURL(this);"  type="file" required="required" accept="image/jpeg, image/png"/>
                            <div style="display: none;">
                                <input name="photo" type="text" id="photo"/>
                            </div>
                        </div>

                    </div>
                    <div class="messagePanel">
                        <h:outputLabel value="#{dealsController.messageError}" id="messagePanel4" style="padding: 0; margin: 0;"/>
                    </div>
                    <div class="control">
                        <div class="backbtn">
                            <h:commandButton class="button" value="Volver" onclick="back(4)" action="#{dealsController.setMessageError('')}">
                                <f:ajax render="messagePanel4"/>
                            </h:commandButton>
                        </div>
                        <div class="frontbtn">
                            <h:commandButton action="#{dealsController.validarTiempoAndRegister()}" class="button" value="Terminar"/>   
                        </div>   
                    </div>
            </div>
        </div>
                   </h:form>
        <h:outputScript name="js/addDeals.js"/>
        <script type="text/javascript" 
                src="/JavaServerFaces/faces/javax.faces.resource/common.js?ln=js">
        </script>
        <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=places&amp;sensor=true&amp;key=AIzaSyB41DRUbKWJHPxaFjMAwdrzWzbVKartNGg"></script>
    </body>
     <script>
    // <![CDATA[
        function initialize() {
          var mapOptions = {
            center: new google.maps.LatLng(-33.8688, 151.2195),
            zoom: 13,
            mapTypeId: google.maps.MapTypeId.ROADMAP
          };
          var map = new google.maps.Map(document.getElementById('map'),
            mapOptions);

          var input = /** @type {HTMLInputElement} */(document.getElementById('location'));
          var autocomplete = new google.maps.places.Autocomplete(input);

          autocomplete.bindTo('bounds', map);

          var infowindow = new google.maps.InfoWindow();
          var marker = new google.maps.Marker({
            map: map
          });

          google.maps.event.addListener(autocomplete, 'place_changed', function() {
            infowindow.close();
            marker.setVisible(false);
            input.className = '';
            var place = autocomplete.getPlace();
            if (!place.geometry) {
              // Inform the user that the place was not found and return.
              input.className = 'notfound';
              return;
            }

            // If the place has a geometry, then present it on a map.
            if (place.geometry.viewport) {
              map.fitBounds(place.geometry.viewport);
            } else {
              map.setCenter(place.geometry.location);
              map.setZoom(17);  // Why 17? Because it looks good.
            }
            marker.setIcon(/** @type {google.maps.Icon} */({
              url: place.icon,
              size: new google.maps.Size(71, 71),
              origin: new google.maps.Point(0, 0),
              anchor: new google.maps.Point(17, 34),
              scaledSize: new google.maps.Size(35, 35)
            }));
            var coordinates = String(place.geometry.location);
            coordinates = coordinates.replace("(","");
            coordinates = coordinates.replace(")","");
            var arrayCoords = coordinates.split(",");
            marker.setPosition(place.geometry.location);
            marker.setVisible(true);
            document.getElementById("latitud").value = arrayCoords[0];
            document.getElementById("longitud").value = arrayCoords[1];

            var address = '';
            if (place.address_components) {
              address = [
                (place.address_components[0] && place.address_components[0].short_name || ''),
                (place.address_components[1] && place.address_components[1].short_name || ''),
                (place.address_components[2] && place.address_components[2].short_name || '')
              ].join(' ');
            }

            infowindow.setContent('<div><strong>' + place.name + '</strong><br>' + address);
            infowindow.open(map, marker);
          });

        }

        google.maps.event.addDomListener(window, 'load', initialize);
    // ]]>
    </script>
  
</html>